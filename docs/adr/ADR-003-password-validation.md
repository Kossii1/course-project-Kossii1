# ADR-005: Password Validation and Tamper Protection
Дата: 2025-10-22
Статус: Accepted

## Context
При регистрации передаётся пароль, и возможна атака с подменой данных.
Если данные не валидируются и не хэшируются должным образом, возможны:
- регистрация с некорректным или пустым паролем,
- XSS/инъекции,
- утечка данных при логировании.

## Decision
- Валидация пароля и данных регистрации на уровне контроллера.
- Хэширование пароля перед сохранением.
- Проверка источника данных (origin).
- Возврат ошибок в формате RFC7807.

## Alternatives
- ❌ Игнорировать проверку — уязвимость к tampering.
- ⚠️ Проверка на клиенте — легко обойти.
- ✅ Серверная валидация + хэширование — защищает надёжно.

## Consequences
- Снижается риск невалидных или вредоносных данных.
- Повышается безопасность хранения паролей.

## Security impact
- Устраняет риск R2.

## Rollout plan
- Реализована валидация и проверка origin.
- Юнит- и интеграционные тесты для проверки невалидного пароля и источника.
- Пилот на dev окружении.
- Полный rollout после QA проверки.

## Links
- Threat Model: регистрация (R1–R6), логин (L1–L7), CRUD тренировок (W1–W4)
- RISKS: R2, R5
- tests/test_auth.py
- PR #p05-secure-coding
- NFR: NFR-01, NFR-05
